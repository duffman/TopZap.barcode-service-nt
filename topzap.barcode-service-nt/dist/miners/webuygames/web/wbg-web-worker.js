'use strict';Object.defineProperty(exports,'__esModule',{value:true});const request=require('request');const wbg_web_data_1=require('./wbg-web-data');class WbgWebWorker{constructor(){this.baseRequest=request.defaults({'baseUrl':'https://www.webuygames.co.uk/','headers':{'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36','Accept-Language':'en-UK','Accept-Encoding':'gzip, deflate, br','Connection':'keep-alive'},'gzip':true});}search(ean,cookieJar){if(!cookieJar){cookieJar=request.jar();}return new Promise((resolve,reject)=>{this.baseRequest.post('wp-admin/admin-ajax.php',{'form':{'action':'addItemToBasket','query':ean},'json':true,'jar':cookieJar},function optionalCallback(err,httpResponse,body){if(err){reject(err);}else{let resultData;try{resultData=wbg_web_data_1.Convert.toWeBuyGamesResult(body['view']);resolve(resultData);}catch(err){resolve(null);}}});});}getCart(cookieJar){return new Promise((resolve,reject)=>{this.baseRequest.get('selling-basket',{'jar':cookieJar},function optionalCallback(err,httpResponse,body){if(err){reject(err);}else{let resultData;try{resultData=wbg_web_data_1.Convert.toWeBuyGamesCartResult(body);resolve(resultData);}catch(err){resolve(null);}}});});}removeFromCart(rowId,cookieJar){return new Promise((resolve,reject)=>{this.baseRequest.post('wp-admin/admin-ajax.php',{'form':{'action':'removeItemFromBasket','id':rowId},'json':true,'jar':cookieJar},function optionalCallback(err,httpResponse,body){if(err){reject(err);}else{let resultData;try{resultData=wbg_web_data_1.Convert.toWeBuyGamesCartSummary(body);resolve(resultData);}catch(err){resolve(null);}}});});}emptyCart(cookieJar){return new Promise((resolve,reject)=>{this.baseRequest.post('wp-admin/admin-ajax.php',{'form':{'action':'emptyBasket'},'json':true,'jar':cookieJar},function optionalCallback(err,httpResponse,body){if(err){reject(err);}else{let resultData;try{resultData=wbg_web_data_1.Convert.toWeBuyGamesCartSummary(body);resolve(resultData);}catch(err){resolve(null);}}});});}}exports.WbgWebWorker=WbgWebWorker;